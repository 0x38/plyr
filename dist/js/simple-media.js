!function(e){"use strict";function t(){var e,t,n,r=navigator.userAgent,o=navigator.appName,s=""+parseFloat(navigator.appVersion),i=parseInt(navigator.appVersion,10);return-1!==navigator.appVersion.indexOf("Windows NT")&&-1!==navigator.appVersion.indexOf("rv:11")?(o="IE",s="11;"):-1!==(t=r.indexOf("MSIE"))?(o="IE",s=r.substring(t+5)):-1!==(t=r.indexOf("Chrome"))?(o="Chrome",s=r.substring(t+7)):-1!==(t=r.indexOf("Safari"))?(o="Safari",s=r.substring(t+7),-1!==(t=r.indexOf("Version"))&&(s=r.substring(t+8))):-1!==(t=r.indexOf("Firefox"))?(o="Firefox",s=r.substring(t+8)):(e=r.lastIndexOf(" ")+1)<(t=r.lastIndexOf("/"))&&(o=r.substring(e,t),s=r.substring(t+1),o.toLowerCase()==o.toUpperCase()&&(o=navigator.appName)),-1!==(n=s.indexOf(";"))&&(s=s.substring(0,n)),-1!==(n=s.indexOf(" "))&&(s=s.substring(0,n)),i=parseInt(""+s,10),isNaN(i)&&(s=""+parseFloat(navigator.appVersion),i=parseInt(navigator.appVersion,10)),[o,i]}function n(e,t,n){return e.replace(new RegExp(t.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1"),"g"),n)}function r(e,t){e.length||(e=[e]);for(var n=e.length-1;n>=0;n--){var r=n>0?t.cloneNode(!0):t,o=e[n],s=o.parentNode,i=o.nextSibling;r.appendChild(o),i?s.insertBefore(r,i):s.appendChild(r)}}function o(e,t,n){if(e)if(e.classList)e.classList[n?"add":"remove"](t);else{var r=(" "+e.className+" ").replace(/\s+/g," ").replace(" "+t+" ","");e.className=r+(n?" "+t:"")}}function s(e,t,n){e.addEventListener(t,n,!1)}function i(e){var t=u().isFullScreen()?{x:0,y:0}:a(e.currentTarget);return{x:e.clientX-t.x,y:e.clientY-t.y}}function a(e){for(var t=0,n=0;e;)t+=e.offsetLeft-e.scrollLeft+e.clientLeft,n+=e.offsetTop-e.scrollTop+e.clientTop,e=e.offsetParent;return{x:t,y:n}}function c(e,t){for(var n in t)t[n]&&t[n].constructor&&t[n].constructor===Object?(e[n]=e[n]||{},c(e[n],t[n])):e[n]=t[n];return e}function u(){var e={supportsFullScreen:!1,isFullScreen:function(){return!1},requestFullScreen:function(){},cancelFullScreen:function(){},fullScreenEventName:"",element:null,prefix:""},t="webkit moz o ms khtml".split(" ");if("undefined"!=typeof document.cancelFullScreen)e.supportsFullScreen=!0;else for(var n=0,r=t.length;r>n;n++)if(e.prefix=t[n],"undefined"!=typeof document[e.prefix+"CancelFullScreen"]){e.supportsFullScreen=!0;break}return"webkit"===e.prefix&&navigator.userAgent.match(/Version\/[\d\.]+.*Safari/)&&(e.supportsFullScreen=!1),e.supportsFullScreen&&(e.fullScreenEventName=e.prefix+"fullscreenchange",e.isFullScreen=function(){switch(this.prefix){case"":return document.fullScreen;case"webkit":return document.webkitIsFullScreen;default:return document[this.prefix+"FullScreen"]}},e.requestFullScreen=function(e){return""===this.prefix?e.requestFullScreen():e[this.prefix+"RequestFullScreen"]("webkit"===this.prefix?e.ALLOW_KEYBOARD_INPUT:null)},e.cancelFullScreen=function(){return""===this.prefix?document.cancelFullScreen():document[this.prefix+"CancelFullScreen"]()},e.element=function(){return""===this.prefix?document.fullscreenElement:document[this.prefix+"FullscreenElement"]}),e}function l(e,t){var n,r=m[e]||[],o=r.length;for(n=0;o>n;n++)r[n].apply(t,[])}function d(e){function a(){for(j.subcount=0;d(j.captions[j.subcount][0])<j.media.currentTime.toFixed(1);)if(j.subcount++,j.subcount>j.captions.length-1){j.subcount=j.captions.length-1;break}}function c(){o(j.container,f.classes.captions.enabled,!0),f.captions.defaultActive&&(o(j.container,f.classes.captions.active,!0),j.buttons.captions.setAttribute("checked","checked"))}function l(e){var t=[];return t=e.split(" --> "),m(t[0])}function d(e){var t=[];return t=e.split(" --> "),m(t[1])}function m(e){if(null===e||void 0===e)return 0;var t,n=[],r=[];return n=e.split(","),r=n[0].split(":"),t=Math.floor(60*r[0]*60)+Math.floor(60*r[1])+Math.floor(r[2])}function b(e){return j.container.querySelectorAll(e)}function g(e){return b(e)[0]}function v(){f.debug&&console.log("Injecting custom controls");var e=f.html;e=n(e,"{aria-label}",f.playAriaLabel),e=n(e,"{id}",j.random),j.container.insertAdjacentHTML("beforeend",e)}function h(){j.controls=g(f.selectors.controls),j.buttons={},j.buttons.play=g(f.selectors.buttons.play),j.buttons.pause=g(f.selectors.buttons.pause),j.buttons.restart=g(f.selectors.buttons.restart),j.buttons.rewind=g(f.selectors.buttons.rewind),j.buttons.forward=g(f.selectors.buttons.forward),j.buttons.mute=g(f.selectors.buttons.mute),j.buttons.captions=g(f.selectors.buttons.captions),j.buttons.fullscreen=g(f.selectors.buttons.fullscreen),j.progress={},j.progress.bar=g(f.selectors.progress),j.progress.text=j.progress.bar.getElementsByTagName("span")[0],j.volume=g(f.selectors.buttons.volume),j.duration=g(f.selectors.duration),j.seekTime=b(f.selectors.seekTime)}function x(){if(j.media=j.container.querySelectorAll("audio, video")[0],!j.media)return console.error("No audio or video element found!"),!1;if(o(j.container,f.classes.stopped,null===j.media.getAttribute("autoplay")),j.media.removeAttribute("controls"),j.type="video"==j.media.tagName.toLowerCase()?"video":"audio","video"===j.type){var e=document.createElement("div");e.setAttribute("class",f.classes.videoContainer),r(j.media,e),j.videoContainer=e}}function y(){if("video"===j.type){j.videoContainer.insertAdjacentHTML("afterbegin","<div class='"+f.selectors.captions.replace(".","")+"'></div>"),j.captionsContainer=g(f.selectors.captions),j.isTextTracks=!1,j.media.textTracks&&(j.isTextTracks=!0);for(var e,t="",n=j.media.childNodes,r=0;r<n.length;r++)"track"===n[r].nodeName.toLowerCase()&&(e=n[r].getAttribute("kind"),"captions"===e&&(t=n[r].getAttribute("src")));if(j.captionExists=!0,""===t?(j.captionExists=!1,f.debug&&console.log("No caption track found.")):f.debug&&console.log("Caption track found; URI: "+t),j.captionExists){var i,a,u={};if("IE"===j.browserName&&10===j.browserMajorVersion||"IE"===j.browserName&&11===j.browserMajorVersion||"Firefox"===j.browserName&&j.browserMajorVersion>=31||"Safari"===j.browserName&&j.browserMajorVersion>=7)for(f.debug&&console.log("Detected IE 10/11 or Firefox 31+ or Safari 7+"),j.isTextTracks=!1,u={},i=j.media.textTracks,a=0;a<i.length;a++)u=j.media.textTracks[a],u.mode="hidden";if(j.isTextTracks)for(f.debug&&console.log("textTracks supported"),c(j),u={},i=j.media.textTracks,a=0;a<i.length;a++)u=j.media.textTracks[a],u.mode="hidden","captions"===u.kind&&s(u,"cuechange",function(){this.activeCues[0]&&this.activeCues[0].hasOwnProperty("text")&&(j.captionsContainer.innerHTML=this.activeCues[0].text)});else if(f.debug&&console.log("textTracks not supported so rendering captions manually"),c(j),j.currentCaption="",j.subcount=0,j.captions=[],s(j.media,"timeupdate",function(){j.media.currentTime.toFixed(1)>l(j.captions[j.subcount][0])&&j.media.currentTime.toFixed(1)<d(j.captions[j.subcount][0])&&(j.currentCaption=j.captions[j.subcount][1]),j.media.currentTime.toFixed(1)>d(j.captions[j.subcount][0])&&j.subcount<j.captions.length-1&&j.subcount++,j.captionsContainer.innerHTML=j.currentCaption}),""!==t){var p;window.XMLHttpRequest?p=new XMLHttpRequest:window.ActiveXObject&&(p=new ActiveXObject("Microsoft.XMLHTTP")),p.onreadystatechange=function(){if(4===p.readyState)if(200===p.status){f.debug&&console.log("xhr = 200"),j.captions=[];var e,t=[],n=p.responseText;t=n.split("\n\n");for(var r=0;r<t.length;r++)e=t[r],j.captions[r]=[],j.captions[r]=e.split("\n");j.captions.shift(),f.debug&&console.log("Successfully loaded the caption file via ajax.")}else f.debug&&console.log("There was a problem loading the caption file via ajax.")},p.open("get",t,!0),p.send()}"Safari"===j.browserName&&7===j.browserMajorVersion&&(f.debug&&console.log("Safari 7 detected; removing track from DOM"),i=j.media.getElementsByTagName("track"),j.media.removeChild(i[0]))}else o(j.container,f.classes.captions.enabled)}}function T(){j.seekTime[0].innerHTML=f.seekInterval,j.seekTime[1].innerHTML=f.seekInterval}function k(){"video"===j.type&&f.fullscreen.enabled&&(f.debug&&console.log(p.supportsFullScreen?"Fullscreen supported":"No fullscreen supported"),p.supportsFullScreen?(f.debug&&console.log("Fullscreen enabled"),o(j.container,f.classes.fullscreen.enabled,!0)):f.debug&&console.warn("Fullscreen not supported"))}function w(){j.media.play(),o(j.container,f.classes.stopped),o(j.container,f.classes.playing,!0)}function S(){j.media.pause(),o(j.container,f.classes.playing),o(j.container,f.classes.stopped,!0)}function F(){j.media.currentTime=0,j.isTextTracks||(j.subcount=0),w()}function M(){var e=j.media.currentTime-f.seekInterval;j.media.currentTime=0>e?0:e,j.isTextTracks||"video"!==j.type||a(j)}function N(){var e=j.media.currentTime+f.seekInterval;j.media.currentTime=e>j.media.duration?j.media.duration:e,j.isTextTracks||"video"!==j.type||a(j)}function C(){p.isFullScreen()?p.cancelFullScreen():p.requestFullScreen(j.container)}function I(e){j.volume.value=e,j.media.volume=parseFloat(e/10),E()}function L(e){"undefined"==typeof active&&(e=!j.media.muted,j.buttons.mute.checked=e),j.media.muted=e,E()}function A(e){"undefined"==typeof e&&(e=-1===j.container.className.indexOf(f.classes.captions.active),j.buttons.captions.checked=e),e?o(j.container,f.classes.captions.active,!0):o(j.container,f.classes.captions.active)}function E(){o(j.container,f.classes.muted,0===j.media.volume||j.media.muted)}function O(){s(j.buttons.fullscreen,"click",C),"video"===j.type&&f.clickToPause&&s(j.videoContainer,"click",function(){j.media.paused?w():j.media.ended?F():S()}),s(j.buttons.play,"click",function(){w(),j.buttons.pause.focus()}),s(j.buttons.pause,"click",function(){S(),j.buttons.play.focus()}),s(j.buttons.restart,"click",F),s(j.buttons.rewind,"click",M),s(j.buttons.forward,"click",N),s(j.volume,"change",function(){I(this.value)}),s(j.buttons.mute,"change",function(){L(this.checked)}),s(j.media,"timeupdate",function(){j.secs=parseInt(j.media.currentTime%60),j.mins=parseInt(j.media.currentTime/60%60),j.secs=("0"+j.secs).slice(-2),j.mins=("0"+j.mins).slice(-2),j.duration.innerHTML=j.mins+":"+j.secs}),s(j.media,"timeupdate",function(){j.percent=100/j.media.duration*j.media.currentTime,j.percent>0&&(j.progress.bar.value=j.percent,j.progress.text.innerHTML=j.percent)}),s(j.progress.bar,"click",function(e){j.pos=i(e).x/this.offsetWidth,j.media.currentTime=j.pos*j.media.duration,j.isTextTracks||"video"!==j.type||a(j)}),s(j.buttons.captions,"click",function(){A(this.checked)}),s(j.media,"ended",function(){"video"===j.type&&(j.captionsContainer.innerHTML=""),o(j.container,f.classes.stopped,!0),o(j.container,f.classes.playing)})}function V(){return p=u(),j.browserInfo=t(),j.browserName=j.browserInfo[0],j.browserMajorVersion=j.browserInfo[1],f.debug&&console.log(j.browserName+" "+j.browserMajorVersion),"IE"!==j.browserName||8!==j.browserMajorVersion&&9!==j.browserMajorVersion?(f.playAriaLabel="undefined"!=typeof f.title&&f.title.length?"Play "+f.title:"Play",x(),j.random=Math.floor(1e4*Math.random()),v(),h(),I(f.volume),k(),y(),T(),O(),void 0):(f.debug&&console.error("Browser not suppported."),!1)}var j=this;return j.container=e,V(),{media:j.media,play:w,pause:S,restart:F,rewind:M,forward:N,setVolume:I,toggleMute:L,toggleCaptions:A}}var p,f,m={},b={enabled:!0,debug:!1,seekInterval:10,volume:5,clickToPause:!0,selectors:{container:".player",controls:".player-controls",buttons:{play:"[data-player='play']",pause:"[data-player='pause']",restart:"[data-player='restart']",rewind:"[data-player='rewind']",forward:"[data-player='fast-forward']",mute:"[data-player='mute']",volume:"[data-player='volume']",captions:"[data-player='captions']",fullscreen:"[data-player='fullscreen']"},progress:".player-progress",captions:".player-captions",duration:".player-duration",seekTime:".player-seek-time"},classes:{videoContainer:"player-video",stopped:"stopped",playing:"playing",muted:"muted",captions:{active:"captions-active",enabled:"captions-enabled"},fullscreen:{enabled:"fullscreen-enabled"}},captions:{defaultActive:!0},fullscreen:{enabled:!0}};e.on=function(e,t){m[e]||(m[e]=[]),m[e].push(t)},e.setup=function(e){if(f=c(b,e),!f.enabled)return!1;for(var t=[],n=document.querySelectorAll(f.selectors.container),r=n.length-1;r>=0;r--){var o=n[r],s=new d(o);t.push(s),o.player=s}return l("setup",t),t}}(this.simpleMedia=this.simpleMedia||{});