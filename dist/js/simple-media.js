!function(e){"use strict";function t(){var e,t,n,r=navigator.userAgent,s=navigator.appName,a=""+parseFloat(navigator.appVersion),o=parseInt(navigator.appVersion,10);return-1!==navigator.appVersion.indexOf("Windows NT")&&-1!==navigator.appVersion.indexOf("rv:11")?(s="IE",a="11;"):-1!==(t=r.indexOf("MSIE"))?(s="IE",a=r.substring(t+5)):-1!==(t=r.indexOf("Chrome"))?(s="Chrome",a=r.substring(t+7)):-1!==(t=r.indexOf("Safari"))?(s="Safari",a=r.substring(t+7),-1!==(t=r.indexOf("Version"))&&(a=r.substring(t+8))):-1!==(t=r.indexOf("Firefox"))?(s="Firefox",a=r.substring(t+8)):(e=r.lastIndexOf(" ")+1)<(t=r.lastIndexOf("/"))&&(s=r.substring(e,t),a=r.substring(t+1),s.toLowerCase()==s.toUpperCase()&&(s=navigator.appName)),-1!==(n=a.indexOf(";"))&&(a=a.substring(0,n)),-1!==(n=a.indexOf(" "))&&(a=a.substring(0,n)),o=parseInt(""+a,10),isNaN(o)&&(a=""+parseFloat(navigator.appVersion),o=parseInt(navigator.appVersion,10)),[s,o]}function n(e){var t=[];return t=e.split(" --> "),s(t[0])}function r(e){var t=[];return t=e.split(" --> "),s(t[1])}function s(e){if(null===e||void 0===e)return 0;var t,n=[],r=[];return n=e.split(","),r=n[0].split(":"),t=Math.floor(60*r[0]*60)+Math.floor(60*r[1])+Math.floor(r[2])}function a(e){for(e.subcount=0;r(e.captions[e.subcount][0])<e.media.currentTime.toFixed(1);)if(e.subcount++,e.subcount>e.captions.length-1){e.subcount=e.captions.length-1;break}}function o(e){e.container.className+=" "+C.classes.captions.enabled,C.captions.defaultActive&&(e.container.className+=" "+C.classes.captions.active,e.buttons.captions.setAttribute("checked","checked"))}function i(e,t,n){return e.replace(new RegExp(t.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1"),"g"),n)}function c(e,t){e.length||(e=[e]);for(var n=e.length-1;n>=0;n--){var r=n>0?t.cloneNode(!0):t,s=e[n],a=s.parentNode,o=s.nextSibling;r.appendChild(s),o?a.insertBefore(r,o):a.appendChild(r)}}function l(e){var t=p().isFullScreen()?{x:0,y:0}:u(e.currentTarget);return{x:e.clientX-t.x,y:e.clientY-t.y}}function u(e){for(var t=0,n=0;e;)t+=e.offsetLeft-e.scrollLeft+e.clientLeft,n+=e.offsetTop-e.scrollTop+e.clientTop,e=e.offsetParent;return{x:t,y:n}}function d(e,t){for(var n in t)t[n]&&t[n].constructor&&t[n].constructor===Object?(e[n]=e[n]||{},d(e[n],t[n])):e[n]=t[n];return e}function p(){var e={supportsFullScreen:!1,isFullScreen:function(){return!1},requestFullScreen:function(){},cancelFullScreen:function(){},fullScreenEventName:"",element:null,prefix:""},t="webkit moz o ms khtml".split(" ");if("undefined"!=typeof document.cancelFullScreen)e.supportsFullScreen=!0;else for(var n=0,r=t.length;r>n;n++)if(e.prefix=t[n],"undefined"!=typeof document[e.prefix+"CancelFullScreen"]){e.supportsFullScreen=!0;break}return"webkit"===e.prefix&&navigator.userAgent.match(/Version\/[\d\.]+.*Safari/)&&(e.supportsFullScreen=!1),e.supportsFullScreen&&(e.fullScreenEventName=e.prefix+"fullscreenchange",e.isFullScreen=function(){switch(this.prefix){case"":return document.fullScreen;case"webkit":return document.webkitIsFullScreen;default:return document[this.prefix+"FullScreen"]}},e.requestFullScreen=function(e){return""===this.prefix?e.requestFullScreen():e[this.prefix+"RequestFullScreen"]("webkit"===this.prefix?e.ALLOW_KEYBOARD_INPUT:null)},e.cancelFullScreen=function(){return""===this.prefix?document.cancelFullScreen():document[this.prefix+"CancelFullScreen"]()},e.element=function(){return""===this.prefix?document.fullscreenElement:document[this.prefix+"FullscreenElement"]}),e}function f(e){var t,n=A[e]||[],r=n.length;for(t=0;r>t;t++)n[t].apply(I.media,[])}function m(){C.debug&&console.log("Injecting custom controls");var e=C.html;e=i(e,"{aria-label}",C.playAriaLabel),e=i(e,"{id}",I.random),I.container.insertAdjacentHTML("beforeend",e)}function b(e){return I.container.querySelectorAll(e)}function v(e){return b(e)[0]}function g(){I.controls=v(C.selectors.controls),I.buttons={},I.buttons.play=v(C.selectors.buttons.play),I.buttons.pause=v(C.selectors.buttons.pause),I.buttons.restart=v(C.selectors.buttons.restart),I.buttons.rewind=v(C.selectors.buttons.rewind),I.buttons.forward=v(C.selectors.buttons.forward),I.buttons.mute=v(C.selectors.buttons.mute),I.buttons.captions=v(C.selectors.buttons.captions),I.buttons.fullscreen=v(C.selectors.buttons.fullscreen),I.progress={},I.progress.bar=v(C.selectors.progress),I.progress.text=I.progress.bar.getElementsByTagName("span")[0],I.volume=v(C.selectors.buttons.volume),I.duration=v(C.selectors.duration),I.seekTime=b(C.selectors.seekTime)}function x(){I.media.play(),I.container.className=I.container.className.replace(C.classes.stopped,C.classes.playing)}function T(){I.media.pause(),I.container.className=I.container.className.replace(C.classes.playing,C.classes.stopped)}function h(){I.media.currentTime=0,I.isTextTracks||(I.subcount=0),x()}function y(){I.volume.value=C.volume,I.media.volume=parseFloat(C.volume/10),k()}function k(){0===I.media.volume||I.media.muted?I.container.className+=" "+C.classes.muted:I.container.className=I.container.className.replace(C.classes.muted,"")}function w(){if(I.media=I.container.querySelectorAll("audio, video")[0],!I.media)return console.error("No audio or video element found!"),!1;if(null===I.media.getAttribute("autoplay")&&(I.container.className+=" "+C.classes.stopped),I.media.removeAttribute("controls"),I.type="video"==I.media.tagName.toLowerCase()?"video":"audio","video"===I.type){var e=document.createElement("div");e.setAttribute("class",C.classes.videoContainer),c(I.media,e),I.videoContainer=e}}function N(){if("video"===I.type){I.videoContainer.insertAdjacentHTML("afterbegin","<div class='"+C.selectors.captions.replace(".","")+"'></div>"),I.captionsContainer=v(C.selectors.captions),I.isTextTracks=!1,I.media.textTracks&&(I.isTextTracks=!0);for(var e,t="",s=I.media.childNodes,a=0;a<s.length;a++)"track"===s[a].nodeName.toLowerCase()&&(e=s[a].getAttribute("kind"),"captions"===e&&(t=s[a].getAttribute("src")));if(I.captionExists=!0,""===t?(I.captionExists=!1,C.debug&&console.log("No caption track found.")):C.debug&&console.log("Caption track found; URI: "+t),I.captionExists){var i,c,l={};if("IE"===I.browserName&&10===I.browserMajorVersion||"IE"===I.browserName&&11===I.browserMajorVersion||"Firefox"===I.browserName&&I.browserMajorVersion>=31||"Safari"===I.browserName&&I.browserMajorVersion>=7)for(C.debug&&console.log("Detected IE 10/11 or Firefox 31+ or Safari 7+"),I.isTextTracks=!1,l={},i=I.media.textTracks,c=0;c<i.length;c++)l=I.media.textTracks[c],l.mode="hidden";if(I.isTextTracks)for(C.debug&&console.log("textTracks supported"),o(I),l={},i=I.media.textTracks,c=0;c<i.length;c++)l=I.media.textTracks[c],l.mode="hidden","captions"===l.kind&&l.addEventListener("cuechange",function(){this.activeCues[0]&&this.activeCues[0].hasOwnProperty("text")&&(I.captionsContainer.innerHTML=this.activeCues[0].text)},!1);else if(C.debug&&console.log("textTracks not supported so rendering captions manually"),o(I),I.currentCaption="",I.subcount=0,I.captions=[],I.media.addEventListener("timeupdate",function(){I.media.currentTime.toFixed(1)>n(I.captions[I.subcount][0])&&I.media.currentTime.toFixed(1)<r(I.captions[I.subcount][0])&&(I.currentCaption=I.captions[I.subcount][1]),I.media.currentTime.toFixed(1)>r(I.captions[I.subcount][0])&&I.subcount<I.captions.length-1&&I.subcount++,I.captionsContainer.innerHTML=I.currentCaption},!1),""!==t){var u;window.XMLHttpRequest?u=new XMLHttpRequest:window.ActiveXObject&&(u=new ActiveXObject("Microsoft.XMLHTTP")),u.onreadystatechange=function(){if(4===u.readyState)if(200===u.status){C.debug&&console.log("xhr = 200"),I.captions=[];var e,t=[],n=u.responseText;t=n.split("\n\n");for(var r=0;r<t.length;r++)e=t[r],I.captions[r]=[],I.captions[r]=e.split("\n");I.captions.shift(),C.debug&&console.log("Successfully loaded the caption file via ajax.")}else C.debug&&console.log("There was a problem loading the caption file via ajax.")},u.open("get",t,!0),u.send()}"Safari"===I.browserName&&7===I.browserMajorVersion&&(C.debug&&console.log("Safari 7 detected; removing track from DOM"),i=I.media.getElementsByTagName("track"),I.media.removeChild(i[0]))}else I.container.className=I.container.className.replace(C.classes.captions.enabled,"")}}function S(){I.seekTime[0].innerHTML=C.seekInterval,I.seekTime[1].innerHTML=C.seekInterval}function F(){"video"===I.type&&C.fullscreen.enabled&&(C.debug&&console.log(M.supportsFullScreen?"Fullscreen supported":"No fullscreen supported"),M.supportsFullScreen?(C.debug&&console.log("Fullscreen enabled"),I.container.className+=" "+C.classes.fullscreen.enabled):C.debug&&console.warn("Fullscreen not supported"))}function L(){I.buttons.fullscreen.addEventListener("click",function(){M.isFullScreen()?M.cancelFullScreen():M.requestFullScreen(I.container)},!1),"video"===I.type&&C.clickToPause&&I.videoContainer.addEventListener("click",function(){I.media.paused?x():I.media.ended?h():T()},!1),I.buttons.play.addEventListener("click",function(){x(),I.buttons.pause.focus()},!1),I.buttons.pause.addEventListener("click",function(){T(),I.buttons.play.focus()},!1),I.buttons.restart.addEventListener("click",h,!1),I.buttons.rewind.addEventListener("click",function(){var e=I.media.currentTime-C.seekInterval;I.media.currentTime=0>e?0:e,I.isTextTracks||"video"!==I.type||a(I)},!1),I.buttons.forward.addEventListener("click",function(){var e=I.media.currentTime+C.seekInterval;I.media.currentTime=e>I.media.duration?I.media.duration:e,I.isTextTracks||"video"!==I.type||a(I)},!1),I.volume.addEventListener("change",function(){C.volume=this.value,y()},!1),I.buttons.mute.addEventListener("click",function(){I.media.muted=I.media.muted===!0?!1:!0,k()},!1),I.media.addEventListener("timeupdate",function(){I.secs=parseInt(I.media.currentTime%60),I.mins=parseInt(I.media.currentTime/60%60),I.secs=("0"+I.secs).slice(-2),I.mins=("0"+I.mins).slice(-2),I.duration.innerHTML=I.mins+":"+I.secs},!1),I.media.addEventListener("timeupdate",function(){I.percent=100/I.media.duration*I.media.currentTime,I.percent>0&&(I.progress.bar.value=I.percent,I.progress.text.innerHTML=I.percent)},!1),I.progress.bar.addEventListener("click",function(e){I.pos=l(e).x/this.offsetWidth,I.media.currentTime=I.pos*I.media.duration,I.isTextTracks||"video"!==I.type||a(I)}),I.buttons.captions.addEventListener("click",function(){this.checked?I.container.className+=" "+C.classes.captions.active:I.container.className=I.container.className.replace(C.classes.captions.active,"")},!1),I.media.addEventListener("ended",function(){"video"===I.type&&(I.captionsContainer.innerHTML=""),I.container.className=I.container.className.replace(C.classes.playing,C.classes.stopped)})}function E(e){I.container=e,w(),I.random=Math.floor(1e4*Math.random()),m(),g(),y(),F(),N(),S(),L()}var M,C,I={},A={},O={enabled:!0,debug:!1,seekInterval:10,volume:5,clickToPause:!0,selectors:{container:".player",controls:".player-controls",buttons:{play:"[data-player='play']",pause:"[data-player='pause']",restart:"[data-player='restart']",rewind:"[data-player='rewind']",forward:"[data-player='fast-forward']",mute:"[data-player='mute']",volume:"[data-player='volume']",captions:"[data-player='captions']",fullscreen:"[data-player='fullscreen']"},progress:".player-progress",captions:".player-captions",duration:".player-duration",seekTime:".player-seek-time"},classes:{videoContainer:"player-video",stopped:"stopped",playing:"playing",muted:"muted",captions:{active:"captions-active",enabled:"captions-enabled"},fullscreen:{enabled:"fullscreen-enabled"}},captions:{defaultActive:!0},fullscreen:{enabled:!0}};e.on=function(e,t){A[e]||(A[e]=[]),A[e].push(t)},e.setup=function(e){if(C=d(O,e),!C.enabled)return!1;if(M=p(),I.browserInfo=t(),I.browserName=I.browserInfo[0],I.browserMajorVersion=I.browserInfo[1],C.debug&&console.log(I.browserName+" "+I.browserMajorVersion),"IE"===I.browserName&&(8===I.browserMajorVersion||9===I.browserMajorVersion))return C.debug&&console.error("Browser not suppported."),!1;C.playAriaLabel="undefined"!=typeof C.title&&C.title.length?"Play "+C.title:"Play";var n=document.querySelector(C.selectors.container);return null===n?(C.debug&&console.error("Selector "+C.selectors.container+" not found!"),!1):(E(n),f("setup"),void 0)}}(this.simpleMedia=this.simpleMedia||{});